<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Prime School: Student Form</title>
  <link rel="stylesheet" href="./bootstrap-3.4.1-dist/css/bootstrap.css">
  <link rel="stylesheet" type="text/css" href="SFI.css" media="screen">

</head>



<body id="bodylist" style="width: 80%; margin: auto;">

<h1 class="h_1">Prime School</h1>
<section id="deets">
  <div>
  <h2 id="under" class="text-center">Form List</h2>
  <table id="tbl" class="table table-striped" style="width: 90%;">
    <thead class="thead-dark">
    <th class="text-center">First Name</th>
    <th class="text-center">Last Name</th class="text-center">
    <th class="text-center">Action</th class="text-center">
  </thead>
  </table>
  </div>
 
    <button class="btn btn-danger btn-sm" style="float: right;  margin: 20px 55px 0 0;"> <a href="SFI.html" class="nav">Return to Student Form Registration</a></button>

</section>
  <script>
       //get first name and last name and append to table
    var z = JSON.parse(localStorage.getItem("form"));
    const Fname = z.map(item => item.firstname);
    const Lname = z.map(item => item.lastname);
    const userId = z.map(item => item.id);
   
    //number of columns in the table
    var th = document.getElementById("tbl").getElementsByTagName('th').length;
   
    //insert rows
    for (a = 0, r = 1; a < z.length; r++,a++) {
      var tr = tbl.insertRow(r);
     
      //insert row cells
    for(c = 0; c<th; c++){
      var td = document.createElement('td');
      td = tr.insertCell(c);
      if (c==0){
        td.innerHTML = Fname[a]; //first name
      }
      else if (c==1){
        td.innerHTML = Lname[a]; //last name
      }
      else{
        var button = document.createElement("button"); //delete button
        button.innerHTML = "Delete";
        button.setAttribute('onclick', 'removeRow(this)');
        td.appendChild(button);

        var details = document.createElement("button"); //details button
      details.innerHTML = "Details";
      td.appendChild(details);
      details.setAttribute("onclick", 'detail(this)' )}}}

    
      function detail(oButton) {                  
        brow = oButton.parentNode.parentNode.rowIndex; //detail button function
        location.href =  "details.html?" + userId[brow-1];
      }

 //delete button function
      function removeRow(oButton) {   
        var result = confirm("Are you sure you want to delete this form?");
if (result) {
  brow = oButton.parentNode.parentNode.rowIndex;      // BUTTON -> TD -> TR.
        document.getElementById('tbl').deleteRow(brow);       
        z.splice((brow-1),1);
        localStorage.clear();
        localStorage.setItem('form', JSON.stringify(z));
}       
      }
      
 

  </script>
  
</body>

</html>
